<!DOCTYPE html>
<html lang="en">
<head id="shared-head">
    <link rel="stylesheet" href="/src/styles/styles.css">
</head>
<body>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script>
        fetch('../templates/head.html')
            .then(resp => resp.text())
            .then(html => {
                document.getElementById('shared-head').innerHTML += html
        })

        function toggle(id){
            const x = $("#" + id)
            if(x.is(":visible")){
                x.addClass("c")
                setTimeout(() => {
                    x.removeClass("c")
                    x.hide()
                }, 300)
            } else {
                x.addClass("o")
                x.show();
                setTimeout(() => {
                    x.removeClass("o")
                }, 300)
            }
        }

        function toggleFloating(id1, id2){
            toggle(id1)
            toggle(id2)
        }
    </script>
    <script src="/src/js/navbar.js"></script>

    <div class="navbar">
    </div>

    <div class="panel">
        <h1>Leaderboard</h1>
        <p>Who's the best spy?</p>
        <div id="leaderboard-list" class="leaderboard">
            <p style="text-align: center;">Loading...</p>
        </div>
    </div>

    <script>
        // Fetch leaderboard data
        fetch('https://eye-spy-backend.onrender.com/leaderboard')
            .then(res => res.json())
            .then(data => {
                const listDiv = document.getElementById('leaderboard-list');
                listDiv.innerHTML = '';
                
                if (data.length === 0) {
                    listDiv.innerHTML = '<p style="text-align: center;">No scores yet. Be the first!</p>';
                    return;
                }
                
                data.forEach((entry, index) => {
                    const div = document.createElement('div');
                    
                    // Add medal emoji for top 3
                    let medal = '';
                    if (index === 0) medal = 'ðŸ¥‡ ';
                    else if (index === 1) medal = 'ðŸ¥ˆ ';
                    else if (index === 2) medal = 'ðŸ¥‰ ';
                    
                    div.innerHTML = `<b>${medal}${index + 1}. ${entry.username}</b> - ${entry.score} points`;
                    listDiv.appendChild(div);
                });
            })
            .catch(err => {
                console.error('Error fetching leaderboard:', err);
                document.getElementById('leaderboard-list').innerHTML = 
                    '<p style="text-align: center; color: red;">Failed to load leaderboard</p>';
            });
    </script>
</body>
</html>
